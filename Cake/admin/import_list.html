<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Qu·∫£n l√Ω Phi·∫øu Nh·∫≠p</title>
  <style>
    body { font-family: Arial,sans-serif; background:#1b1b1b; color:#eee; padding:20px; }
    h2 { color:#ffcc00; margin-bottom:20px; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { padding:10px; border:1px solid #333; text-align:center; }
    th { background:#2a2a2a; color:#ffcc00; }
    tr:nth-child(even) { background:#333; }
    tr:nth-child(odd) { background:#222; }
    button { padding:6px 12px; border:none; border-radius:6px; cursor:pointer; margin:3px; font-weight:bold; }
    .btn-add { background:#ffcc00; color:#111; }
    .btn-edit { background:#0d6efd; color:#fff; }
    .btn-complete { background:#28a745; color:#fff; }

    #formContainer { 
      display:none; 
      margin-top:20px; 
      max-width:500px; 
      background:#2c2c2c; 
      padding:20px; 
      border-radius:12px; 
      box-shadow:0 4px 12px rgba(0,0,0,0.4);
    }
    #formContainer label { display:block; margin-top:10px; margin-bottom:5px; }
    #formContainer input { width:100%; padding:8px; border-radius:6px; border:1px solid #555; background:#333; color:#fff; }
    #formContainer button { margin-top:15px; }

    .btn-home-container { text-align:center; margin-top:30px; }
    .btn-home {
      background:#ffcc00; 
      color:#111; 
      padding:10px 20px; 
      border-radius:8px;
      text-decoration:none;
      font-weight:bold;
    }
  </style>
</head>
<body>

  <h2>Qu·∫£n l√Ω Phi·∫øu Nh·∫≠p</h2>

  <button class="btn-add" onclick="showAddForm()">Th√™m phi·∫øu nh·∫≠p m·ªõi</button>

  <table>
    <thead>
      <tr>
        <th>STT</th>
        <th>Ng√†y nh·∫≠p</th>
        <th>S·∫£n ph·∫©m</th>
        <th>Gi√° nh·∫≠p</th>
        <th>S·ªë l∆∞·ª£ng</th>
        <th>Tr·∫°ng th√°i</th>
        <th>H√†nh ƒë·ªông</th>
      </tr>
    </thead>
    <tbody id="receiptTable"></tbody>
  </table>

  <div id="formContainer">
    <h3 id="formTitle">Th√™m Phi·∫øu Nh·∫≠p</h3>
    <label>T√™n s·∫£n ph·∫©m:</label>
    <input type="text" id="productInput" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m...">

    <label>Gi√° nh·∫≠p:</label>
    <input type="number" id="priceInput">

    <label>S·ªë l∆∞·ª£ng:</label>
    <input type="number" id="quantityInput">

    <label>Ng√†y nh·∫≠p:</label>
    <input type="date" id="dateInput">

    <button onclick="saveReceipt()">L∆∞u phi·∫øu</button>
    <button onclick="hideForm()">H·ªßy</button>
  </div>

  <div class="btn-home-container">
    <a href="index.html" class="btn-home">üè† Quay v·ªÅ Trang ch·ªß</a>
  </div>

  <!-- ‚úÖ CHUY·ªÇN SCRIPT XU·ªêNG CU·ªêI BODY -->
  <script>
    let receipts = [];

    function initData() {
      try {
        receipts = JSON.parse(localStorage.getItem("receipts")) || [];
        if (receipts.length === 0) {
          receipts = [
            { product: "B√°nh M√¨ B∆° T·ªèi", price: 12000, quantity: 50, date: "2025-10-15", completed: true },
            { product: "B√°nh Kem D√¢u T√¢y", price: 85000, quantity: 10, date: "2025-10-10", completed: false },
            { product: "B√°nh Flan Tr·ª©ng", price: 8000, quantity: 60, date: "2025-10-18", completed: true },
            { product: "B√°nh Bao Nh√¢n Th·ªãt", price: 15000, quantity: 40, date: "2025-10-12", completed: false },
            { product: "B√°nh Su Kem S·ªØa T∆∞∆°i", price: 10000, quantity: 45, date: "2025-10-20", completed: true }
          ];
          localStorage.setItem("receipts", JSON.stringify(receipts));
        }
      } catch (e) {
        receipts = [];
        localStorage.removeItem("receipts");
      }
    }

    function renderReceipts() {
      const tbody = document.getElementById("receiptTable");
      tbody.innerHTML = receipts.map((r, i) => `
        <tr>
          <td>${i + 1}</td>
          <td>${r.date}</td>
          <td>${r.product}</td>
          <td>${r.price.toLocaleString('vi-VN')} ‚Ç´</td>
          <td>${r.quantity}</td>
          <td>${r.completed ? "Ho√†n th√†nh" : "Ch∆∞a ho√†n th√†nh"}</td>
          <td>
            ${r.completed ? "" : `
              <button class="btn-edit" onclick="editReceipt(${i})">S·ª≠a</button>
              <button class="btn-complete" onclick="completeReceipt(${i})">Ho√†n th√†nh</button>
            `}
          </td>
        </tr>
      `).join('');
    }

    function showAddForm() {
      document.getElementById("formContainer").style.display = "block";
      document.getElementById("formTitle").innerText = "Th√™m Phi·∫øu Nh·∫≠p";
      document.getElementById("productInput").value = "";
      document.getElementById("priceInput").value = "";
      document.getElementById("quantityInput").value = "";
      document.getElementById("dateInput").value = "";
      delete window.editIndex;
    }

    function hideForm() {
      document.getElementById("formContainer").style.display = "none";
    }

    function saveReceipt() {
      const product = document.getElementById("productInput").value.trim();
      const price = parseInt(document.getElementById("priceInput").value);
      const quantity = parseInt(document.getElementById("quantityInput").value);
      const date = document.getElementById("dateInput").value;

      if (!product || !price || !quantity || !date) {
        alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!");
        return;
      }

      if (window.editIndex !== undefined) {
        receipts[window.editIndex] = { product, price, quantity, date, completed: false };
        delete window.editIndex;
      } else {
        receipts.push({ product, price, quantity, date, completed: false });
      }

      localStorage.setItem("receipts", JSON.stringify(receipts));
      renderReceipts();
      hideForm();
    }

    function editReceipt(index) {
      const r = receipts[index];
      window.editIndex = index;
      document.getElementById("formContainer").style.display = "block";
      document.getElementById("formTitle").innerText = "S·ª≠a Phi·∫øu Nh·∫≠p";
      document.getElementById("productInput").value = r.product;
      document.getElementById("priceInput").value = r.price;
      document.getElementById("quantityInput").value = r.quantity;
      document.getElementById("dateInput").value = r.date;
    }

    function completeReceipt(index) {
      receipts[index].completed = true;
      localStorage.setItem("receipts", JSON.stringify(receipts));
      renderReceipts();
    }

    // ‚úÖ G·ªåI NGAY SAU KHI DOM T·∫¢I
    document.addEventListener("DOMContentLoaded", () => {
      initData();
      renderReceipts();
    });
  </script>
</body>
</html>
